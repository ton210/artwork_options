<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <%- include('../partials/favicon') %>
  <%- include('../partials/analytics') %>
  <title>Cannabis Tools & Calculators - Complete Suite</title>
  <meta name="description" content="Professional cannabis tools: dosage calculator, strain finder, dispensary comparison, onset timer, medical card ROI, tolerance break planner, and more.">

  <!-- SEO Enhancements -->
  <link rel="canonical" href="<%= baseUrl %>/tools">
  <meta property="og:title" content="10 Free Cannabis Calculators - Professional Tools Suite">
  <meta property="og:description" content="Science-backed cannabis tools for dosing, strain selection, savings, ROI, tolerance breaks & more. Used by thousands. 100% free!">
  <meta property="og:url" content="<%= baseUrl %>/tools">
  <meta property="og:type" content="website">

  <!-- Schema.org -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Cannabis Tools & Calculators",
    "url": "<%= baseUrl %>/tools",
    "applicationCategory": "HealthApplication",
    "offers": {"@type": "Offer", "price": "0", "priceCurrency": "USD"},
    "featureList": ["Dosage Calculator", "Strain Finder", "Savings Calculator", "Medical ROI", "Tolerance Planner", "Onset Timer"]
  }
  </script>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; }
    .tool-card { transition: transform 0.2s, box-shadow 0.2s; }
    .tool-card:hover { transform: translateY(-4px); box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1); }
    .tab-button.active { background: #16a34a; color: white; }
    .result-card { animation: slideIn 0.3s ease-out; }
    @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
  </style>
</head>
<body class="bg-gray-50">
  <%- include('../partials/header') %>

  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <!-- Header -->
    <div class="text-center mb-12">
      <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-4">üß™ Cannabis Tools & Calculators</h1>
      <p class="text-xl text-gray-600 mb-2">Professional-grade tools for smarter cannabis decisions</p>
      <p class="text-gray-500">Science-backed ‚Ä¢ Free Forever ‚Ä¢ No Sign-Up Required</p>
    </div>

    <!-- Stats -->
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-12">
      <div class="bg-white rounded-lg shadow p-6 text-center">
        <div class="text-3xl font-bold text-green-600">10</div>
        <div class="text-sm text-gray-600">Professional Tools</div>
      </div>
      <div class="bg-white rounded-lg shadow p-6 text-center">
        <div class="text-3xl font-bold text-blue-600">100%</div>
        <div class="text-sm text-gray-600">Accurate</div>
      </div>
      <div class="bg-white rounded-lg shadow p-6 text-center">
        <div class="text-3xl font-bold text-purple-600">‚àû</div>
        <div class="text-sm text-gray-600">Unlimited Use</div>
      </div>
      <div class="bg-white rounded-lg shadow p-6 text-center">
        <div class="text-3xl font-bold text-orange-600">FREE</div>
        <div class="text-sm text-gray-600">Always Free</div>
      </div>
    </div>

    <!-- Tab Navigation -->
    <div class="bg-white rounded-lg shadow-lg mb-8 p-2">
      <div class="flex flex-wrap gap-2">
        <button onclick="switchTab('dosing')" class="tab-button active px-4 py-2 rounded-lg font-medium transition" data-tab="dosing">
          üíä Dosing & Safety
        </button>
        <button onclick="switchTab('strains')" class="tab-button px-4 py-2 rounded-lg font-medium transition" data-tab="strains">
          üåø Strain Selection
        </button>
        <button onclick="switchTab('savings')" class="tab-button px-4 py-2 rounded-lg font-medium transition" data-tab="savings">
          üí∞ Money & Savings
        </button>
        <button onclick="switchTab('comparison')" class="tab-button px-4 py-2 rounded-lg font-medium transition" data-tab="comparison">
          ‚öñÔ∏è Comparison
        </button>
        <button onclick="switchTab('planning')" class="tab-button px-4 py-2 rounded-lg font-medium transition" data-tab="planning">
          üìÖ Planning
        </button>
      </div>
    </div>

    <!-- Tab Content -->
    <div id="tab-content">
      <!-- DOSING & SAFETY TAB -->
      <div id="dosing-tab" class="tab-content">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">

          <!-- Enhanced Dosage Calculator -->
          <div class="bg-white rounded-lg shadow-lg p-8 tool-card">
            <h2 class="text-2xl font-bold mb-2">üßÆ Advanced Dosage Calculator</h2>
            <p class="text-gray-600 mb-6">Personalized THC dosing based on multiple factors</p>

            <div class="space-y-4">
              <div>
                <label class="block text-sm font-semibold mb-2">Experience Level</label>
                <select id="exp-level" class="w-full px-4 py-2 border-2 rounded-lg focus:border-green-500 focus:outline-none">
                  <option value="first-time">First Time Ever</option>
                  <option value="beginner">Beginner (1-5 times)</option>
                  <option value="occasional">Occasional (Monthly)</option>
                  <option value="regular">Regular (Weekly)</option>
                  <option value="experienced">Experienced (Daily)</option>
                </select>
              </div>

              <div>
                <label class="block text-sm font-semibold mb-2">Body Weight: <span id="weight-display">150 lbs</span></label>
                <input type="range" id="body-weight" min="80" max="300" value="150"
                       class="w-full" oninput="document.getElementById('weight-display').textContent = this.value + ' lbs'">
              </div>

              <div>
                <label class="block text-sm font-semibold mb-2">Metabolism Speed</label>
                <select id="metabolism" class="w-full px-4 py-2 border-2 rounded-lg focus:border-green-500 focus:outline-none">
                  <option value="slow">Slow (effects last longer)</option>
                  <option value="average" selected>Average</option>
                  <option value="fast">Fast (effects shorter)</option>
                </select>
              </div>

              <div>
                <label class="block text-sm font-semibold mb-2">Last Meal</label>
                <select id="food-status" class="w-full px-4 py-2 border-2 rounded-lg focus:border-green-500 focus:outline-none">
                  <option value="empty">Empty Stomach (no food 4+ hours)</option>
                  <option value="light">Light Snack (within 2 hours)</option>
                  <option value="full" selected>Full Meal (within 2 hours)</option>
                </select>
              </div>

              <div>
                <label class="block text-sm font-semibold mb-2">Desired Effect Intensity</label>
                <select id="intensity-level" class="w-full px-4 py-2 border-2 rounded-lg focus:border-green-500 focus:outline-none">
                  <option value="microdose">Microdose (barely noticeable)</option>
                  <option value="mild">Mild (light, functional)</option>
                  <option value="moderate" selected>Moderate (clear high)</option>
                  <option value="strong">Strong (intense)</option>
                </select>
              </div>

              <button onclick="calculateAdvancedDosage()"
                      class="w-full bg-gradient-to-r from-green-600 to-green-700 text-white font-bold py-4 rounded-lg hover:from-green-700 hover:to-green-800 transition shadow-lg">
                Calculate Personalized Dose
              </button>

              <div id="advanced-dosage-result" class="hidden result-card mt-6 p-6 bg-gradient-to-r from-green-50 to-blue-50 border-2 border-green-200 rounded-lg">
                <div class="text-center mb-4">
                  <div class="text-sm text-gray-600 mb-1">Recommended Dosage:</div>
                  <div id="dose-amount" class="text-5xl font-bold text-green-600"></div>
                </div>
                <div id="dose-details" class="space-y-3 text-sm"></div>
                <canvas id="dosage-chart" class="mt-4" height="150"></canvas>
              </div>
            </div>
          </div>

          <!-- Onset Time Calculator -->
          <div class="bg-white rounded-lg shadow-lg p-8 tool-card">
            <h2 class="text-2xl font-bold mb-2">‚è±Ô∏è Onset Time & Duration Calculator</h2>
            <p class="text-gray-600 mb-6">Plan your session with accurate timing predictions</p>

            <div class="space-y-4">
              <div>
                <label class="block text-sm font-semibold mb-2">Product Type</label>
                <select id="product-type" class="w-full px-4 py-2 border-2 rounded-lg focus:border-green-500 focus:outline-none">
                  <option value="smoking">Smoking (Joint, Pipe, Bong)</option>
                  <option value="vaping">Vaping (Cartridge, Dry Herb)</option>
                  <option value="edibles">Edibles (Gummies, Chocolates, Baked)</option>
                  <option value="tincture">Tincture (Sublingual)</option>
                  <option value="topical">Topical (Cream, Lotion)</option>
                  <option value="dabbing">Dabbing (Concentrates)</option>
                </select>
              </div>

              <div>
                <label class="block text-sm font-semibold mb-2">Dosage (mg THC)</label>
                <input type="number" id="onset-dosage" value="10" min="1" max="200"
                       class="w-full px-4 py-2 border-2 rounded-lg focus:border-green-500 focus:outline-none">
              </div>

              <div>
                <label class="block text-sm font-semibold mb-2">Time Since Last Meal</label>
                <select id="meal-timing" class="w-full px-4 py-2 border-2 rounded-lg focus:border-green-500 focus:outline-none">
                  <option value="0">Just ate (within 30 min)</option>
                  <option value="1">1-2 hours ago</option>
                  <option value="3">3-4 hours ago</option>
                  <option value="5">5+ hours ago (empty)</option>
                </select>
              </div>

              <button onclick="calculateOnsetTime()"
                      class="w-full bg-gradient-to-r from-blue-600 to-blue-700 text-white font-bold py-4 rounded-lg hover:from-blue-700 hover:to-blue-800 transition shadow-lg">
                Calculate Onset & Duration
              </button>

              <div id="onset-result" class="hidden result-card mt-6 p-6 bg-blue-50 border-2 border-blue-200 rounded-lg">
                <div id="onset-timeline" class="space-y-4"></div>
                <canvas id="onset-chart" class="mt-4" height="120"></canvas>
              </div>
            </div>
          </div>

        </div>
      </div>

      <!-- STRAINS TAB -->
      <div id="strains-tab" class="tab-content hidden">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">

          <!-- Enhanced Strain Finder -->
          <div class="bg-white rounded-lg shadow-lg p-8 tool-card">
            <h2 class="text-2xl font-bold mb-2">üîç Advanced Strain Finder</h2>
            <p class="text-gray-600 mb-6">7-question quiz for perfect strain matching</p>

            <div id="strain-quiz" class="space-y-4">
              <div>
                <label class="block text-sm font-semibold mb-2">1. When will you use it?</label>
                <select id="sq-time" class="w-full px-4 py-2 border-2 rounded-lg focus:border-green-500 focus:outline-none">
                  <option value="morning">Morning (6am-12pm)</option>
                  <option value="afternoon">Afternoon (12pm-6pm)</option>
                  <option value="evening">Evening (6pm-10pm)</option>
                  <option value="night">Night (10pm+)</option>
                </select>
              </div>

              <div>
                <label class="block text-sm font-semibold mb-2">2. Primary goal?</label>
                <select id="sq-goal" class="w-full px-4 py-2 border-2 rounded-lg focus:border-green-500 focus:outline-none">
                  <option value="relax">Relaxation & Stress Relief</option>
                  <option value="sleep">Sleep & Insomnia</option>
                  <option value="pain">Pain Management</option>
                  <option value="energy">Energy & Motivation</option>
                  <option value="focus">Focus & Productivity</option>
                  <option value="creative">Creativity & Inspiration</option>
                  <option value="social">Social & Fun</option>
                  <option value="appetite">Appetite Stimulation</option>
                </select>
              </div>

              <div>
                <label class="block text-sm font-semibold mb-2">3. Preferred flavor profile?</label>
                <select id="sq-flavor" class="w-full px-4 py-2 border-2 rounded-lg focus:border-green-500 focus:outline-none">
                  <option value="citrus">Citrus & Fruity</option>
                  <option value="earthy">Earthy & Woody</option>
                  <option value="sweet">Sweet & Dessert-like</option>
                  <option value="diesel">Diesel & Fuel</option>
                  <option value="pine">Pine & Herbal</option>
                  <option value="berry">Berry & Floral</option>
                </select>
              </div>

              <div>
                <label class="block text-sm font-semibold mb-2">4. Sensitivity to anxiety/paranoia?</label>
                <select id="sq-anxiety" class="w-full px-4 py-2 border-2 rounded-lg focus:border-green-500 focus:outline-none">
                  <option value="low">Low - doesn't affect me</option>
                  <option value="medium" selected>Medium - sometimes an issue</option>
                  <option value="high">High - avoid high THC</option>
                </select>
              </div>

              <button onclick="runAdvancedStrainFinder()"
                      class="w-full bg-gradient-to-r from-purple-600 to-purple-700 text-white font-bold py-4 rounded-lg hover:from-purple-700 hover:to-purple-800 transition shadow-lg">
                Find My Perfect Strains
              </button>

              <div id="advanced-strain-result" class="hidden result-card mt-6 p-6 bg-purple-50 border-2 border-purple-200 rounded-lg">
                <div id="strain-matches" class="space-y-4"></div>
              </div>
            </div>
          </div>

          <!-- Terpene Matcher Enhanced -->
          <div class="bg-white rounded-lg shadow-lg p-8 tool-card">
            <h2 class="text-2xl font-bold mb-2">üß¨ Terpene Profile Builder</h2>
            <p class="text-gray-600 mb-6">Build your ideal terpene profile for maximum benefits</p>

            <div class="space-y-4">
              <p class="text-sm font-medium mb-3">Select all effects you want:</p>

              <div class="grid grid-cols-2 gap-3">
                <label class="flex items-center gap-2 p-3 border-2 rounded-lg cursor-pointer hover:bg-green-50 hover:border-green-500 transition">
                  <input type="checkbox" class="terp-effect" value="relaxation" class="rounded">
                  <span class="text-sm">üòå Relaxation</span>
                </label>
                <label class="flex items-center gap-2 p-3 border-2 rounded-lg cursor-pointer hover:bg-green-50 hover:border-green-500 transition">
                  <input type="checkbox" class="terp-effect" value="energy" class="rounded">
                  <span class="text-sm">‚ö° Energy</span>
                </label>
                <label class="flex items-center gap-2 p-3 border-2 rounded-lg cursor-pointer hover:bg-green-50 hover:border-green-500 transition">
                  <input type="checkbox" class="terp-effect" value="pain" class="rounded">
                  <span class="text-sm">ü©π Pain Relief</span>
                </label>
                <label class="flex items-center gap-2 p-3 border-2 rounded-lg cursor-pointer hover:bg-green-50 hover:border-green-500 transition">
                  <input type="checkbox" class="terp-effect" value="sleep" class="rounded">
                  <span class="text-sm">üò¥ Sleep</span>
                </label>
                <label class="flex items-center gap-2 p-3 border-2 rounded-lg cursor-pointer hover:bg-green-50 hover:border-green-500 transition">
                  <input type="checkbox" class="terp-effect" value="mood" class="rounded">
                  <span class="text-sm">üòä Mood Boost</span>
                </label>
                <label class="flex items-center gap-2 p-3 border-2 rounded-lg cursor-pointer hover:bg-green-50 hover:border-green-500 transition">
                  <input type="checkbox" class="terp-effect" value="focus" class="rounded">
                  <span class="text-sm">üéØ Focus</span>
                </label>
                <label class="flex items-center gap-2 p-3 border-2 rounded-lg cursor-pointer hover:bg-green-50 hover:border-green-500 transition">
                  <input type="checkbox" class="terp-effect" value="anxiety" class="rounded">
                  <span class="text-sm">üßò Anti-Anxiety</span>
                </label>
                <label class="flex items-center gap-2 p-3 border-2 rounded-lg cursor-pointer hover:bg-green-50 hover:border-green-500 transition">
                  <input type="checkbox" class="terp-effect" value="inflammation" class="rounded">
                  <span class="text-sm">üî• Anti-Inflammatory</span>
                </label>
              </div>

              <button onclick="buildTerpeneProfile()"
                      class="w-full bg-gradient-to-r from-indigo-600 to-indigo-700 text-white font-bold py-4 rounded-lg hover:from-indigo-700 hover:to-indigo-800 transition shadow-lg">
                Build My Terpene Profile
              </button>

              <div id="terpene-profile-result" class="hidden result-card mt-6 p-6 bg-indigo-50 border-2 border-indigo-200 rounded-lg">
                <div id="terpene-recommendations" class="space-y-3"></div>
                <div class="mt-4 pt-4 border-t">
                  <div class="text-sm font-semibold mb-2">Recommended Strains:</div>
                  <div id="terpene-strains" class="flex flex-wrap gap-2"></div>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>

      <!-- SAVINGS TAB -->
      <div id="savings-tab" class="tab-content hidden">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">

          <!-- Enhanced Savings Calculator -->
          <div class="bg-white rounded-lg shadow-lg p-8 tool-card">
            <h2 class="text-2xl font-bold mb-2">üí∏ Annual Savings Calculator</h2>
            <p class="text-gray-600 mb-6">See how much you can save with smart shopping</p>

            <div class="space-y-4">
              <div>
                <label class="block text-sm font-semibold mb-2">Weekly Budget: $<span id="budget-display">50</span></label>
                <input type="range" id="weekly-spend" min="10" max="500" value="50" step="10"
                       class="w-full" oninput="document.getElementById('budget-display').textContent = this.value">
              </div>

              <div>
                <label class="block text-sm font-semibold mb-2">Average Discount (%): <span id="discount-display">15</span>%</label>
                <input type="range" id="avg-discount" min="0" max="50" value="15"
                       class="w-full" oninput="document.getElementById('discount-display').textContent = this.value">
              </div>

              <div>
                <label class="block text-sm font-semibold mb-2">Loyalty Cashback (%): <span id="loyalty-display">5</span>%</label>
                <input type="range" id="loyalty-cash" min="0" max="20" value="5"
                       class="w-full" oninput="document.getElementById('loyalty-display').textContent = this.value">
              </div>

              <div>
                <label class="block text-sm font-semibold mb-2">Bulk Purchase Discount (%): <span id="bulk-display">10</span>%</label>
                <input type="range" id="bulk-discount" min="0" max="30" value="10"
                       class="w-full" oninput="document.getElementById('bulk-display').textContent = this.value">
              </div>

              <button onclick="calculateCompleteSavings()"
                      class="w-full bg-gradient-to-r from-green-600 to-emerald-700 text-white font-bold py-4 rounded-lg hover:from-green-700 hover:to-emerald-800 transition shadow-lg">
                Calculate Total Savings
              </button>

              <div id="complete-savings-result" class="hidden result-card mt-6 p-6 bg-green-50 border-2 border-green-200 rounded-lg">
                <div class="grid grid-cols-2 gap-4 mb-4">
                  <div class="text-center p-4 bg-white rounded-lg">
                    <div class="text-sm text-gray-600">Annual Spending</div>
                    <div id="total-spend" class="text-2xl font-bold text-gray-900"></div>
                  </div>
                  <div class="text-center p-4 bg-green-100 rounded-lg">
                    <div class="text-sm text-gray-600">Total Savings</div>
                    <div id="total-save" class="text-2xl font-bold text-green-600"></div>
                  </div>
                </div>
                <div id="savings-breakdown" class="text-sm space-y-2"></div>
                <canvas id="savings-chart" class="mt-4" height="150"></canvas>
              </div>
            </div>
          </div>

          <!-- Medical Card ROI Calculator -->
          <div class="bg-white rounded-lg shadow-lg p-8 tool-card">
            <h2 class="text-2xl font-bold mb-2">üí≥ Medical Card ROI Calculator</h2>
            <p class="text-gray-600 mb-6">Is a medical card worth it for you?</p>

            <div class="space-y-4">
              <div>
                <label class="block text-sm font-semibold mb-2">Monthly Cannabis Spending ($)</label>
                <input type="number" id="monthly-spending" value="200" min="20" max="2000" step="10"
                       class="w-full px-4 py-2 border-2 rounded-lg focus:border-green-500 focus:outline-none">
              </div>

              <div>
                <label class="block text-sm font-semibold mb-2">Medical Card Cost ($)</label>
                <input type="number" id="card-cost" value="150" min="50" max="500"
                       class="w-full px-4 py-2 border-2 rounded-lg focus:border-green-500 focus:outline-none">
                <p class="text-xs text-gray-500 mt-1">Typical: $100-200/year</p>
              </div>

              <div>
                <label class="block text-sm font-semibold mb-2">Recreational Tax Rate (%)</label>
                <input type="number" id="rec-tax" value="25" min="0" max="40"
                       class="w-full px-4 py-2 border-2 rounded-lg focus:border-green-500 focus:outline-none">
              </div>

              <div>
                <label class="block text-sm font-semibold mb-2">Medical Tax Rate (%)</label>
                <input type="number" id="med-tax" value="5" min="0" max="15"
                       class="w-full px-4 py-2 border-2 rounded-lg focus:border-green-500 focus:outline-none">
              </div>

              <button onclick="calculateMedicalROI()"
                      class="w-full bg-gradient-to-r from-purple-600 to-purple-700 text-white font-bold py-4 rounded-lg hover:from-purple-700 hover:to-purple-800 transition shadow-lg">
                Calculate ROI
              </button>

              <div id="medical-roi-result" class="hidden result-card mt-6 p-6 bg-purple-50 border-2 border-purple-200 rounded-lg">
                <div id="roi-summary" class="mb-4"></div>
                <div id="roi-recommendation" class="p-4 rounded-lg font-semibold text-center"></div>
                <canvas id="roi-chart" class="mt-4" height="150"></canvas>
              </div>
            </div>
          </div>

          <!-- Product Type Recommender -->
          <div class="bg-white rounded-lg shadow-lg p-8 tool-card">
            <h2 class="text-2xl font-bold mb-2">üì¶ Product Type Recommender</h2>
            <p class="text-gray-600 mb-6">Find the best consumption method for your lifestyle</p>

            <div class="space-y-4">
              <div>
                <label class="block text-sm font-semibold mb-2">How important is discretion?</label>
                <select id="discretion" class="w-full px-4 py-2 border-2 rounded-lg focus:border-green-500 focus:outline-none">
                  <option value="very">Very Important (need to be subtle)</option>
                  <option value="somewhat">Somewhat Important</option>
                  <option value="not">Not Important</option>
                </select>
              </div>

              <div>
                <label class="block text-sm font-semibold mb-2">Convenience priority?</label>
                <select id="convenience" class="w-full px-4 py-2 border-2 rounded-lg focus:border-green-500 focus:outline-none">
                  <option value="high">High - want grab and go</option>
                  <option value="medium" selected>Medium</option>
                  <option value="low">Low - don't mind preparation</option>
                </select>
              </div>

              <div>
                <label class="block text-sm font-semibold mb-2">Budget preference?</label>
                <select id="budget-pref" class="w-full px-4 py-2 border-2 rounded-lg focus:border-green-500 focus:outline-none">
                  <option value="budget">Budget-Conscious</option>
                  <option value="moderate" selected>Moderate</option>
                  <option value="premium">Premium Quality</option>
                </select>
              </div>

              <div>
                <label class="block text-sm font-semibold mb-2">Lung health concern?</label>
                <select id="lung-health" class="w-full px-4 py-2 border-2 rounded-lg focus:border-green-500 focus:outline-none">
                  <option value="yes">Yes - avoid smoking</option>
                  <option value="no" selected>No concerns</option>
                </select>
              </div>

              <button onclick="recommendProductType()"
                      class="w-full bg-gradient-to-r from-orange-600 to-orange-700 text-white font-bold py-4 rounded-lg hover:from-orange-700 hover:to-orange-800 transition shadow-lg">
                Get Recommendation
              </button>

              <div id="product-type-result" class="hidden result-card mt-6 p-6 bg-orange-50 border-2 border-orange-200 rounded-lg">
                <div id="product-recommendations" class="space-y-4"></div>
              </div>
            </div>
          </div>

        </div>
      </div>

      <!-- COMPARISON TAB -->
      <div id="comparison-tab" class="tab-content hidden">
        <div class="bg-white rounded-lg shadow-lg p-8">
          <h2 class="text-3xl font-bold mb-2">‚öñÔ∏è Dispensary Comparison Tool</h2>
          <p class="text-gray-600 mb-6">Compare up to 3 dispensaries side-by-side</p>

          <div class="mb-6">
            <label class="block text-sm font-semibold mb-2">Search and select dispensaries to compare:</label>
            <input type="text" id="dispensary-search" placeholder="Search by name or location..."
                   class="w-full px-4 py-3 border-2 rounded-lg focus:border-green-500 focus:outline-none">
            <div id="search-results" class="mt-2 space-y-1"></div>
          </div>

          <div id="selected-dispensaries" class="mb-6">
            <div class="text-sm font-semibold mb-3">Selected for comparison:</div>
            <div id="comparison-list" class="space-y-2"></div>
          </div>

          <button onclick="compareDispensaries()" id="compare-btn" disabled
                  class="w-full bg-gradient-to-r from-blue-600 to-blue-700 text-white font-bold py-4 rounded-lg hover:from-blue-700 hover:to-blue-800 transition shadow-lg disabled:opacity-50 disabled:cursor-not-allowed">
            Compare Dispensaries
          </button>

          <div id="comparison-result" class="hidden result-card mt-8">
            <div id="comparison-table" class="overflow-x-auto"></div>
          </div>
        </div>
      </div>

      <!-- PLANNING TAB -->
      <div id="planning-tab" class="tab-content hidden">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">

          <!-- Tolerance Break Calculator -->
          <div class="bg-white rounded-lg shadow-lg p-8 tool-card">
            <h2 class="text-2xl font-bold mb-2">üîÑ Tolerance Break Planner</h2>
            <p class="text-gray-600 mb-6">Reset your tolerance and save money</p>

            <div class="space-y-4">
              <div>
                <label class="block text-sm font-semibold mb-2">Current Usage Frequency</label>
                <select id="usage-freq" class="w-full px-4 py-2 border-2 rounded-lg focus:border-green-500 focus:outline-none">
                  <option value="daily-heavy">Multiple times daily</option>
                  <option value="daily">Once daily</option>
                  <option value="frequent">4-6 times per week</option>
                  <option value="weekly">1-3 times per week</option>
                  <option value="occasional">Occasional (monthly)</option>
                </select>
              </div>

              <div>
                <label class="block text-sm font-semibold mb-2">Daily Amount (approx)</label>
                <select id="daily-amount" class="w-full px-4 py-2 border-2 rounded-lg focus:border-green-500 focus:outline-none">
                  <option value="light">Light (1-2 sessions, <100mg THC)</option>
                  <option value="moderate">Moderate (3-5 sessions, 100-300mg THC)</option>
                  <option value="heavy">Heavy (6+ sessions, 300mg+ THC)</option>
                </select>
              </div>

              <div>
                <label class="block text-sm font-semibold mb-2">Weekly Spending ($)</label>
                <input type="number" id="t-break-budget" value="100" min="10" max="1000"
                       class="w-full px-4 py-2 border-2 rounded-lg focus:border-green-500 focus:outline-none">
              </div>

              <button onclick="planToleranceBreak()"
                      class="w-full bg-gradient-to-r from-teal-600 to-teal-700 text-white font-bold py-4 rounded-lg hover:from-teal-700 hover:to-teal-800 transition shadow-lg">
                Plan My T-Break
              </button>

              <div id="t-break-result" class="hidden result-card mt-6 p-6 bg-teal-50 border-2 border-teal-200 rounded-lg">
                <div id="t-break-plan" class="space-y-4"></div>
              </div>
            </div>
          </div>

          <!-- Effects Timer (Live Session Tracker) -->
          <div class="bg-white rounded-lg shadow-lg p-8 tool-card">
            <h2 class="text-2xl font-bold mb-2">‚è∞ Effects Duration Timer</h2>
            <p class="text-gray-600 mb-6">Track your session in real-time</p>

            <div class="space-y-4">
              <div>
                <label class="block text-sm font-semibold mb-2">What did you consume?</label>
                <select id="timer-product" class="w-full px-4 py-2 border-2 rounded-lg focus:border-green-500 focus:outline-none">
                  <option value="smoking">Smoking/Vaping (instant)</option>
                  <option value="edible">Edible (30min-2hr onset)</option>
                  <option value="tincture">Tincture (15-45min onset)</option>
                  <option value="topical">Topical (localized)</option>
                </select>
              </div>

              <div>
                <label class="block text-sm font-semibold mb-2">Amount (mg THC)</label>
                <input type="number" id="timer-dose" value="10" min="1" max="200"
                       class="w-full px-4 py-2 border-2 rounded-lg focus:border-green-500 focus:outline-none">
              </div>

              <button onclick="startEffectsTimer()" id="timer-start-btn"
                      class="w-full bg-gradient-to-r from-blue-600 to-blue-700 text-white font-bold py-4 rounded-lg hover:from-blue-700 hover:to-blue-800 transition shadow-lg">
                Start Timer
              </button>

              <div id="effects-timer-display" class="hidden result-card mt-6 p-6 bg-blue-50 border-2 border-blue-200 rounded-lg">
                <div class="text-center mb-4">
                  <div class="text-6xl font-bold text-blue-600" id="timer-display">00:00</div>
                  <div class="text-sm text-gray-600 mt-2" id="timer-status">Session started</div>
                </div>
                <div id="timer-milestones" class="space-y-2 text-sm"></div>
                <button onclick="stopEffectsTimer()"
                        class="w-full mt-4 bg-red-500 text-white font-bold py-2 rounded-lg hover:bg-red-600 transition">
                  Stop Timer
                </button>
              </div>
            </div>
          </div>

        </div>
      </div>

    </div>

    <!-- CTA Section -->
    <div class="mt-12 bg-gradient-to-r from-green-600 to-green-700 text-white rounded-lg p-8 text-center">
      <h2 class="text-3xl font-bold mb-4">Ready to Find Your Perfect Dispensary?</h2>
      <p class="text-xl mb-6">Browse thousands of rated dispensaries across North America</p>
      <div class="flex flex-wrap justify-center gap-4">
        <a href="/" class="inline-block bg-white text-green-600 font-bold px-8 py-3 rounded-lg hover:bg-green-50 transition">
          Browse Dispensaries ‚Üí
        </a>
        <a href="/blog" class="inline-block bg-green-500 text-white font-bold px-8 py-3 rounded-lg hover:bg-green-400 transition">
          Read Our Guides ‚Üí
        </a>
      </div>
    </div>
  </div>

  <!-- Tools JavaScript -->
  <script src="/js/tools-enhanced.js"></script>

  <%- include('../partials/footer') %>
</body>
</html>
